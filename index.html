<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Informações - Slideshow</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; }
        #site-frame { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body>

    <iframe id="site-frame" src="" title="Slideshow de Páginas Operacionais"></iframe>

    <script>
        const sites = [
            { nome: "Relógio", url: "https://jpleiria.github.io/Relogio_painel/", tempo: 30000 },
            { nome: "Viaturas", url: "https://app.gescorp.pt/app/quartel/fvd.php?display=VIATU&key=xuvPnG2JEsuVNy%2FEK9%2Ff%2BhkLSOKo%2BBWl%3ADsDe5ZjIOcb9Bg9kQ1zTUBc3gOmptb4%2B", tempo: 20000 },
            { nome: "Bombeiros", url: "https://app.gescorp.pt/app/quartel/fvd.php?display=BOMBE&key=xuvPnG2JEsuVNy%2FEK9%2Ff%2BhkLSOKo%2BBWl%3ADsDe5ZjIOcb9Bg9kQ1zTUBc3gOmptb4%2B", tempo: 15000 }
        ];

        const URL_TROCA_TURNO = "https://jpleiria.github.io/troca_turno/";
        const DURACAO_TROCA_TURNO = 60000; // Quanto tempo a tela de troca fica visível (ex: 60s)
        
        let indiceAtual = 0;
        let timeoutSlideshow;
        let emTrocaDeTurno = false; // Variável de controlo
        const iframe = document.getElementById('site-frame');

        function carregarSlideshow() {
            if (emTrocaDeTurno) return; // Se estiver na troca de turno, não muda o slide

            const siteAtual = sites[indiceAtual];
            console.log(`Carregando: ${siteAtual.nome}`);
            iframe.src = siteAtual.url;

            indiceAtual = (indiceAtual + 1) % sites.length;
            timeoutSlideshow = setTimeout(carregarSlideshow, siteAtual.tempo);
        }

        function verificarHorario() {
            const agora = new Date();
            const hora = agora.getHours();
            const minuto = agora.getMinutes();
            const segundo = agora.getSeconds();

            // Ativa exatamente às 08:00:00 ou 20:00:00
            if ((hora === 8 || hora === 20) && minuto === 0 && segundo === 0 && !emTrocaDeTurno) {
                console.log("Iniciando período de Troca de Turno.");
                
                emTrocaDeTurno = true;
                clearTimeout(timeoutSlideshow); // Para o carrossel
                iframe.src = URL_TROCA_TURNO;

                // Após o tempo definido, volta ao normal
                setTimeout(() => {
                    console.log("Fim da Troca de Turno. Voltando ao slideshow.");
                    emTrocaDeTurno = false;
                    carregarSlideshow(); 
                }, DURACAO_TROCA_TURNO);
            }
        }

        // Verifica o relógio a cada 1 segundo para precisão
        setInterval(verificarHorario, 1000);

        // Inicia o slideshow pela primeira vez
        carregarSlideshow();
    </script>
</body>
</html>